2025-09-01 16:24:31,844 - MarketRegimeScanner - INFO - Using local timezone: America/Chicago
2025-09-01 16:24:31,844 - MarketRegimeScanner - INFO - Database path: C:\Users\kyung\StockScanner\core\ticker_data.db
2025-09-01 16:24:31,845 - MarketRegimeScanner - INFO - Using composite indices: ^IXIC
2025-09-01 16:24:31,847 - MarketRegimeScanner - INFO - Market regime database path: C:\Users\kyung\StockScanner\core\market_regime_data.db
2025-09-01 16:24:31,862 - MarketRegimeScanner - INFO - Loaded 3251 tickers from database
2025-09-01 16:24:31,863 - MarketRegimeScanner - INFO - Ticker scanner started
2025-09-01 16:24:31,864 - MarketRegimeScanner - INFO - Market regime scanner started
2025-09-01 16:24:31,865 - MarketRegimeScanner - INFO - Starting immediate ticker scan on startup
2025-09-01 16:24:31,865 - MarketRegimeScanner - INFO - Starting full ticker refresh
2025-09-01 16:24:31,865 - MarketRegimeScanner - INFO - Fetching tickers for composite index ^IXIC
2025-09-01 16:24:33,061 - MarketRegimeScanner - INFO - Completed ^IXIC: 3251 stocks across 6 pages
2025-09-01 16:24:33,158 - MarketRegimeScanner - INFO - Ticker refresh completed in 1.29s
2025-09-01 16:24:33,158 - MarketRegimeScanner - INFO - Total: 3251 | Added: 0 | Removed: 0
2025-09-01 16:24:33,158 - MarketRegimeScanner - INFO - Database: 0 inserted, 3251 updated
2025-09-01 16:24:33,160 - MarketRegimeScanner - INFO - Initial ticker scan completed successfully
2025-09-01 16:24:33,161 - MarketRegimeScanner - INFO - Next ticker refresh scheduled at 2025-09-02 08:30:00-05:00 (16.0 hours and 5.0 minutes from now)
2025-09-01 16:24:33,871 - MarketRegimeScanner - INFO - Waiting for initial ticker scan to complete before starting market regime scan
2025-09-01 16:24:38,883 - MarketRegimeScanner - INFO - Starting immediate market regime scan
2025-09-01 16:24:38,883 - MarketRegimeScanner - INFO - Starting market regime scan
2025-09-01 16:24:38,883 - MarketRegimeScanner - INFO - Fetching 365 days of market data for regime analysis
2025-09-01 16:24:39,247 - MarketRegimeScanner - INFO - Fetched market data with shape: (249, 1)
2025-09-01 16:24:39,339 - MarketRegimeScanner - INFO - Calculated advanced features with shape: (199, 13)
2025-09-01 16:24:39,454 - MarketRegimeScanner - ERROR - Error during market regime scan: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2025-09-01 16:24:39,501 - MarketRegimeScanner - ERROR - Traceback (most recent call last):
  File "c:\Users\kyung\StockScanner\core\backtest\marketregime_with_backtest.py", line 1798, in scan_market_regime
    self.train_enhanced_ensemble(features)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "c:\Users\kyung\StockScanner\core\backtest\marketregime_with_backtest.py", line 1459, in train_enhanced_ensemble
    pca_features = self.pca.fit_transform(scaled_features)
  File "C:\Users\kyung\AppData\Local\Programs\Python\Python313\Lib\site-packages\sklearn\utils\_set_output.py", line 316, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\Users\kyung\AppData\Local\Programs\Python\Python313\Lib\site-packages\sklearn\base.py", line 1363, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\Users\kyung\AppData\Local\Programs\Python\Python313\Lib\site-packages\sklearn\decomposition\_pca.py", line 466, in fit_transform
    U, S, _, X, x_is_centered, xp = self._fit(X)
                                    ~~~~~~~~~^^^
  File "C:\Users\kyung\AppData\Local\Programs\Python\Python313\Lib\site-packages\sklearn\decomposition\_pca.py", line 503, in _fit
    X = validate_data(
        self,
    ...<5 lines>...
        copy=False,
    )
  File "C:\Users\kyung\AppData\Local\Programs\Python\Python313\Lib\site-packages\sklearn\utils\validation.py", line 2954, in validate_data
    out = check_array(X, input_name="X", **check_params)
  File "C:\Users\kyung\AppData\Local\Programs\Python\Python313\Lib\site-packages\sklearn\utils\validation.py", line 1105, in check_array
    _assert_all_finite(
    ~~~~~~~~~~~~~~~~~~^
        array,
        ^^^^^^
    ...<2 lines>...
        allow_nan=ensure_all_finite == "allow-nan",
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\kyung\AppData\Local\Programs\Python\Python313\Lib\site-packages\sklearn\utils\validation.py", line 120, in _assert_all_finite
    _assert_all_finite_element_wise(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        X,
        ^^
    ...<4 lines>...
        input_name=input_name,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\kyung\AppData\Local\Programs\Python\Python313\Lib\site-packages\sklearn\utils\validation.py", line 169, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains NaN.
PCA does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values

2025-09-01 16:24:39,502 - MarketRegimeScanner - WARNING - Initial market regime scan encountered errors
2025-09-01 16:24:39,502 - MarketRegimeScanner - INFO - Next market regime scan at 17:00:00 (0.0 hours and 35.0 minutes from now)
2025-09-01 16:28:48,355 - MarketRegimeScanner - INFO - Ticker scanner stopped
2025-09-01 16:28:48,355 - MarketRegimeScanner - INFO - Market regime scanner stopped
2025-09-01 16:28:48,356 - MarketRegimeScanner - INFO - Main task cancelled
2025-09-01 16:28:48,356 - MarketRegimeScanner - INFO - Ticker scanner stopped
2025-09-01 16:28:48,356 - MarketRegimeScanner - INFO - Ticker scanner shutdown complete
2025-09-01 16:28:48,356 - MarketRegimeScanner - INFO - Market regime scanner stopped
2025-09-01 16:28:48,356 - MarketRegimeScanner - INFO - Market regime scanner shutdown complete
2025-09-01 16:28:48,357 - MarketRegimeScanner - INFO - Sleep interrupted by shutdown
2025-09-01 16:28:48,357 - MarketRegimeScanner - INFO - Sleep interrupted by shutdown
